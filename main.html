<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Generador de Contrase√±as Seguras</title>
    <style>
      :root {
        --bg: #0b1020;
        --card: #121a33;
        --text: #e8ecff;
        --muted: #9fb0ff;
        --accent: #6ea8ff;
        --good: #22c55e;
        --warn: #f59e0b;
        --bad: #ef4444;
        --radius: 16px;
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto,
          "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji",
          "Segoe UI Emoji";
        color: var(--text);
        background: radial-gradient(
          1200px 800px at 10% 10%,
          #0e1633 0%,
          var(--bg) 40%,
          #070a16 100%
        );
        min-height: 100svh; /* Asegura cubrir alto de la pantalla */
        display: flex; /* Usa Flexbox para centrar el contenido */
        align-items: center; /* Centra verticalmente */
        justify-content: center;
        padding: 24px;
      }

      .app {
        /* Contenedor principal de la app */
        display: flex; /* Habilita layout flexible */
        flex-direction: column; /* Acomoda elementos en columna */
        gap: 16px; /* Espaciado entre hijos */
        width: 100%; /* Ocupa todo el ancho disponible */
        max-width: 720px; /* Limita el ancho m√°ximo para buena lectura */
        background: var(--card); /* Fondo de tarjeta */
        border-radius: var(--radius); /* Bordes redondeados suaves */
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.35); /* Sombra para profundidad */
        padding: 20px; /* Espaciado interno del contenedor */
        border: 1px solid rgba(255, 255, 255, 0.06); /* Borde sutil para contraste */
      }

      header {
        /* Encabezado de la app */
        display: flex; /* Layout horizontal */
        align-items: center; /* Centra verticalmente el contenido */
        justify-content: space-between; /* Separa t√≠tulo y acciones */
        gap: 12px; /* Espaciado entre elementos */
        flex-wrap: wrap; /* Permite que pase a otra l√≠nea en pantallas estrechas */
      }

      h1 {
        /* Estilo del t√≠tulo principal */
        font-size: clamp(18px, 3.5vw, 24px); /* Tama√±o fluido del texto */
        margin: 0; /* Sin margen para ajuste fino */
        letter-spacing: 0.2px; /* Espaciado leve de letras */
      }

      .muted {
        color: var(--muted);
      } /* Clase de texto secundario */

      .row {
        /* L√≠nea flexible para agrupar controles */
        display: flex; /* Activa Flexbox */
        gap: 12px; /* Espaciado entre elementos */
        align-items: center; /* Alinea verticalmente los hijos */
        flex-wrap: wrap; /* Permite salto de l√≠nea si falta espacio */
      }

      .field {
        /* Contenedor de campo/entrada */
        display: flex; /* Flexbox para alinear etiqueta y control */
        flex-direction: column; /* Coloca etiqueta arriba y control abajo */
        gap: 8px; /* Espaciado entre etiqueta y control */
        flex: 1; /* Que ocupe el espacio disponible */
        min-width: 220px; /* Previene que encoja demasiado */
      }

      label {
        /* Estilo general de etiquetas */
        font-size: 14px; /* Tama√±o legible para etiquetas */
        color: var(--muted); /* Color secundario */
      }

      input[type="text"] {
        /* Estilo del campo de contrase√±a generada */
        width: 100%; /* Ocupa todo el ancho del contenedor */
        padding: 14px 16px; /* Espaciado interno confortable */
        border-radius: 12px; /* Bordes redondeados */
        background: #0f1630; /* Fondo oscuro para contraste */
        border: 1px solid rgba(255, 255, 255, 0.08); /* Borde sutil */
        color: var(--text); /* Texto claro sobre fondo oscuro */
        font-size: 16px; /* Tama√±o de fuente legible */
        letter-spacing: 0.6px; /* Aumenta legibilidad de contrase√±as */
      }

      button {
        /* Estilo base para botones */
        padding: 12px 16px; /* Espaciado interno c√≥modo */
        background: linear-gradient(
          180deg,
          #3b82f6,
          #2563eb
        ); /* Gradiente azul para llamar la atenci√≥n */
        color: white; /* Texto blanco sobre fondo azul */
        border: none; /* Sin borde por defecto */
        border-radius: 12px; /* Bordes redondeados suaves */
        cursor: pointer; /* Cambia cursor a mano para indicar acci√≥n */
        font-weight: 600; /* Peso de fuente para resaltar */
        box-shadow: 0 8px 24px rgba(59, 130, 246, 0.35); /* Sombra sutil para profundidad */
        transition: transform 0.08s ease; /* Animaci√≥n suave al presionar */
      }

      button:active {
        transform: translateY(1px);
      } /* Efecto al hacer click */

      .options {
        /* Contenedor de opciones de generaci√≥n */
        display: grid; /* Usa grid para distribuir opciones */
        grid-template-columns: repeat(
          auto-fit,
          minmax(220px, 1fr)
        ); /* Columas responsivas */
        gap: 12px; /* Espaciado entre opciones */
      }

      .optionCard {
        /* Tarjeta para cada opci√≥n */
        display: flex; /* Flexbox para contenido interno */
        align-items: center; /* Centra verticalmente */
        gap: 10px; /* Espaciado entre checkbox/label */
        background: #0f1630; /* Fondo oscuro coherente */
        padding: 12px; /* Espaciado interno */
        border-radius: 12px; /* Bordes redondeados */
        border: 1px solid rgba(255, 255, 255, 0.06); /* Borde sutil */
      }

      .rangeRow {
        /* Fila que contiene el slider de longitud */
        display: flex; /* Flexbox horizontal */
        align-items: center; /* Centra verticalmente */
        gap: 12px; /* Espaciado entre slider y n√∫mero */
      }

      input[type="range"] {
        /* Estilo para el control deslizante */
        width: 100%; /* Que ocupe el ancho disponible */
        accent-color: var(
          --accent
        ); /* Color del pulgar/track soportado por navegadores modernos */
      }

      .meter {
        /* Contenedor de la barra de fuerza */
        width: 100%; /* Ocupa el ancho disponible */
        height: 12px; /* Alto de la barra */
        border-radius: 999px; /* Bordes redondeados completos */
        background: rgba(255, 255, 255, 0.08); /* Fondo base de la barra */
        overflow: hidden; /* Recorta el progreso a los bordes redondeados */
        border: 1px solid rgba(255, 255, 255, 0.06); /* Borde sutil */
      }

      .meterFill {
        /* Barra interior que representa la fuerza */
        height: 100%; /* Misma altura que el contenedor */
        width: 0%; /* Ancho inicial (0%) hasta calcular */
        background: linear-gradient(
          90deg,
          var(--bad),
          var(--warn),
          var(--good)
        ); /* Gradiente de rojo a verde */
        transition: width 0.2s ease; /* Animaci√≥n suave al cambiar */
      }

      .entropy {
        /* Texto que muestra bits de entrop√≠a */
        font-variant-numeric: tabular-nums; /* Alinea n√∫meros para f√°cil lectura */
      }

      .footer {
        /* Pie con nota informativa */
        color: var(--muted); /* Color secundario */
        font-size: 13px; /* Tama√±o peque√±o */
        line-height: 1.4; /* Altura de l√≠nea c√≥moda */
      }
    </style>
    <!-- Fin de estilos CSS -->
  </head>
  <body>
    <!-- Cuerpo del documento donde se muestra la app -->
    <main class="app" role="region" aria-label="Generador de contrase√±as">
      <!-- Contenedor principal con rol accesible -->
      <header>
        <!-- Encabezado con t√≠tulo y acciones -->
        <h1>üîê Generador de contrase√±as seguras</h1>
        <!-- T√≠tulo visible de la aplicaci√≥n -->
        <div class="row">
          <!-- Fila para acciones r√°pidas -->
          <button
            id="copyBtn"
            type="button"
            aria-live="polite"
            title="Copiar contrase√±a"
          >
            Copiar
          </button>
          <!-- Bot√≥n para copiar al portapapeles -->
          <button
            id="generateBtn"
            type="button"
            title="Generar nueva contrase√±a"
          >
            Generar
          </button>
          <!-- Bot√≥n para generar contrase√±a -->
        </div>
      </header>

      <div class="field">
        <!-- Campo que muestra la contrase√±a generada -->
        <label for="passwordOutput">Contrase√±a</label>
        <!-- Etiqueta accesible del campo -->
        <input
          id="passwordOutput"
          type="text"
          placeholder="Toca Generar"
          aria-readonly="true"
          readonly
        />
        <!-- Caja de texto de solo lectura para mostrar la contrase√±a -->
      </div>

      <section class="options" aria-label="Opciones de generaci√≥n">
        <!-- Secci√≥n con opciones personalizables -->
        <div class="field">
          <!-- Campo para seleccionar longitud -->
          <label for="lengthRange"
            >Longitud: <strong id="lengthValue">16</strong> caracteres</label
          >
          <!-- Etiqueta del slider con valor actual -->
          <div class="rangeRow">
            <!-- Contenedor del slider y n√∫mero -->
            <input
              id="lengthRange"
              type="range"
              min="8"
              max="64"
              value="16"
              step="1"
              aria-valuemin="8"
              aria-valuemax="64"
              aria-valuenow="16"
            />
            <!-- Control deslizante de longitud -->
            <input
              id="lengthNumber"
              type="number"
              min="8"
              max="64"
              value="16"
              step="1"
              aria-label="Longitud en n√∫mero"
              style="width: 90px"
            />
            <!-- Campo num√©rico sincronizado -->
          </div>
        </div>

        <div class="optionCard">
          <!-- Opci√≥n para incluir min√∫sculas -->
          <input
            id="includeLower"
            type="checkbox"
            checked
            aria-label="Incluir min√∫sculas"
          />
          <!-- Checkbox de min√∫sculas -->
          <label for="includeLower">Incluir min√∫sculas (a‚Äìz)</label>
          <!-- Etiqueta descriptiva -->
        </div>

        <div class="optionCard">
          <!-- Opci√≥n para incluir may√∫sculas -->
          <input
            id="includeUpper"
            type="checkbox"
            checked
            aria-label="Incluir may√∫sculas"
          />
          <!-- Checkbox de may√∫sculas -->
          <label for="includeUpper">Incluir may√∫sculas (A‚ÄìZ)</label>
          <!-- Etiqueta descriptiva -->
        </div>

        <div class="optionCard">
          <!-- Opci√≥n para incluir n√∫meros -->
          <input
            id="includeNumbers"
            type="checkbox"
            checked
            aria-label="Incluir n√∫meros"
          />
          <!-- Checkbox de n√∫meros -->
          <label for="includeNumbers">Incluir n√∫meros (0‚Äì9)</label>
          <!-- Etiqueta descriptiva -->
        </div>

        <div class="optionCard">
          <!-- Opci√≥n para incluir s√≠mbolos -->
          <input
            id="includeSymbols"
            type="checkbox"
            aria-label="Incluir s√≠mbolos"
          />
          <!-- Checkbox de s√≠mbolos -->
          <label for="includeSymbols">Incluir s√≠mbolos (!@#$‚Ä¶)</label>
          <!-- Etiqueta descriptiva -->
        </div>
      </section>

      <section aria-label="Fuerza de la contrase√±a">
        <!-- Secci√≥n para barra de fuerza y texto -->
        <div class="row">
          <!-- Fila que aloja barra y etiquetas -->
          <div class="meter" aria-hidden="true">
            <!-- Contenedor visual de la barra -->
            <div id="meterFill" class="meterFill"></div>
            <!-- Relleno que crece seg√∫n fuerza -->
          </div>
          <span id="strengthLabel" class="muted">Fuerza: ‚Äî</span>
          <!-- Texto que describe la fuerza -->
          <span
            id="entropyBits"
            class="muted entropy"
            title="Estimaci√≥n te√≥rica basada en longitud y variedad de caracteres"
            >Entrop√≠a: ‚Äî bits</span
          >
          <!-- Texto que muestra entrop√≠a -->
        </div>
      </section>

      <p class="footer">
        <!-- Nota informativa al usuario -->
        Consejo: us√° una contrase√±a <em>larga</em> y activ√°
        <strong>s√≠mbolos</strong>. Guardala en un gestor de contrase√±as. La
        entrop√≠a es una estimaci√≥n te√≥rica (no analiza palabras del
        diccionario).
      </p>
    </main>

    <script>
      // Comienza el script JavaScript
      // =====================
      // Utilidades aleatorias
      // =====================

      const cryptoRand = (maxExclusive) => {
        // Genera un entero aleatorio seguro de 0 a maxExclusive-1
        const array = new Uint32Array(1); // Crea un arreglo para almacenar un entero de 32 bits
        crypto.getRandomValues(array); // Llena el arreglo con n√∫meros aleatorios criptogr√°ficamente fuertes
        return array[0] % maxExclusive; // Devuelve el n√∫mero dentro del rango usando m√≥dulo
      };

      const pickRandom = (str) => str[cryptoRand(str.length)]; // Elige un car√°cter aleatorio de un string

      const shuffle = (arr) => {
        // Mezcla un arreglo in-place con Fisher‚ÄìYates
        for (let i = arr.length - 1; i > 0; i--) {
          // Recorre el arreglo de atr√°s hacia adelante
          const j = cryptoRand(i + 1); // Elige √≠ndice aleatorio entre 0 e i inclusive
          [arr[i], arr[j]] = [arr[j], arr[i]]; // Intercambia los elementos en i y j
        }
        return arr; // Devuelve el arreglo mezclado
      };

      // =====================
      // Conjuntos de caracteres
      // =====================

      const LOWER = "abcdefghijklmnopqrstuvwxyz"; // Define las letras min√∫sculas
      const UPPER = "ABCDEFGHIJKLMNOPQRSTUVWXYZ"; // Define las letras may√∫sculas
      const DIGITS = "0123456789"; // Define los d√≠gitos num√©ricos
      const SYMBOLS = "!@#$%^&*()-_=+[]{};:,.<>/?|~"; // Define s√≠mbolos comunes

      // =====================
      // Referencias a elementos
      // =====================

      const passwordOutput = document.getElementById("passwordOutput"); // Obtiene el input de salida
      const lengthRange = document.getElementById("lengthRange"); // Obtiene el slider de longitud
      const lengthNumber = document.getElementById("lengthNumber"); // Obtiene el input num√©rico de longitud
      const lengthValue = document.getElementById("lengthValue"); // Obtiene el span que muestra el valor

      const includeLower = document.getElementById("includeLower"); // Checkbox de min√∫sculas
      const includeUpper = document.getElementById("includeUpper"); // Checkbox de may√∫sculas
      const includeNumbers = document.getElementById("includeNumbers"); // Checkbox de n√∫meros
      const includeSymbols = document.getElementById("includeSymbols"); // Checkbox de s√≠mbolos

      const meterFill = document.getElementById("meterFill"); // Barra de fuerza visual
      const strengthLabel = document.getElementById("strengthLabel"); // Texto de fuerza
      const entropyBits = document.getElementById("entropyBits"); // Texto de entrop√≠a

      const generateBtn = document.getElementById("generateBtn"); // Bot√≥n de generar
      const copyBtn = document.getElementById("copyBtn"); // Bot√≥n de copiar

      // =====================
      // Sincronizaci√≥n de longitud
      // =====================

      const syncLength = (value) => {
        // Mantiene sincronizados slider, n√∫mero y etiqueta
        const v = Math.max(8, Math.min(64, Number(value))); // Asegura que el valor est√© en rango 8‚Äì64
        lengthRange.value = String(v); // Actualiza el slider con el valor
        lengthNumber.value = String(v); // Actualiza el input num√©rico
        lengthValue.textContent = String(v); // Actualiza el texto visible
      };

      lengthRange.addEventListener("input", (e) => syncLength(e.target.value)); // Sincroniza al mover el slider
      lengthNumber.addEventListener("input", (e) => syncLength(e.target.value)); // Sincroniza al cambiar el n√∫mero

      // =====================
      // C√°lculo de entrop√≠a y fuerza
      // =====================

      const log2 = (n) => Math.log(n) / Math.log(2); // Convierte logaritmo natural a base 2

      const estimateEntropyBits = (length, poolSize) => length * log2(poolSize); // Estima bits de entrop√≠a = L * log2(pool)

      const strengthFromEntropy = (bits) => {
        // Mapea bits a una etiqueta y porcentaje
        if (bits < 50) return { label: "D√©bil", pct: 20, color: "var(--bad)" }; // Menos de 50 bits = d√©bil
        if (bits < 80) return { label: "Media", pct: 45, color: "var(--warn)" }; // 50‚Äì79 bits = media
        if (bits < 110)
          return { label: "Fuerte", pct: 75, color: "var(--accent)" }; // 80‚Äì109 bits = fuerte
        return { label: "Excelente", pct: 100, color: "var(--good)" }; // 110+ bits = excelente
      };

      const updateStrengthUI = (pwd, poolSize) => {
        // Actualiza barra/etiquetas seg√∫n contrase√±a
        const bits = pwd.length ? estimateEntropyBits(pwd.length, poolSize) : 0; // Calcula entrop√≠a si hay contrase√±a
        const { label, pct, color } = strengthFromEntropy(bits); // Obtiene etiqueta/porcentaje/color
        meterFill.style.width = pct + "%"; // Ajusta el ancho de la barra
        meterFill.style.background = color; // Ajusta el color seg√∫n fuerza
        strengthLabel.textContent = "Fuerza: " + (pwd ? label : "‚Äî"); // Actualiza etiqueta de fuerza
        entropyBits.textContent =
          "Entrop√≠a: " + (pwd ? bits.toFixed(1) : "‚Äî") + " bits"; // Muestra bits con 1 decimal
      };

      // =====================
      // Generaci√≥n de contrase√±a
      // =====================

      const buildPool = () => {
        // Construye el conjunto total de caracteres seleccionados
        let pool = ""; // Inicializa el pool vac√≠o
        if (includeLower.checked) pool += LOWER; // Agrega min√∫sculas si est√° marcado
        if (includeUpper.checked) pool += UPPER; // Agrega may√∫sculas si est√° marcado
        if (includeNumbers.checked) pool += DIGITS; // Agrega d√≠gitos si est√° marcado
        if (includeSymbols.checked) pool += SYMBOLS; // Agrega s√≠mbolos si est√° marcado
        return pool; // Devuelve el pool final
      };

      const atLeastOneFromEach = () => {
        // Garantiza al menos un car√°cter de cada tipo seleccionado
        const chars = []; // Arreglo para caracteres obligatorios
        if (includeLower.checked) chars.push(pickRandom(LOWER)); // A√±ade una min√∫scula si aplica
        if (includeUpper.checked) chars.push(pickRandom(UPPER)); // A√±ade una may√∫scula si aplica
        if (includeNumbers.checked) chars.push(pickRandom(DIGITS)); // A√±ade un d√≠gito si aplica
        if (includeSymbols.checked) chars.push(pickRandom(SYMBOLS)); // A√±ade un s√≠mbolo si aplica
        return chars; // Devuelve los caracteres obligatorios
      };

      const generatePassword = () => {
        // Genera la contrase√±a final seg√∫n opciones
        const length = Number(lengthRange.value); // Lee la longitud elegida
        const pool = buildPool(); // Construye el conjunto de caracteres
        if (!pool) {
          // Si no hay conjuntos seleccionados
          alert("Seleccion√° al menos un tipo de car√°cter."); // Muestra alerta al usuario
          return ""; // Devuelve cadena vac√≠a para indicar falla
        }
        const mustHave = atLeastOneFromEach(); // Obtiene caracteres obligatorios
        const result = [...mustHave]; // Inicia el resultado con los obligatorios
        while (result.length < length) {
          // Completa hasta alcanzar la longitud
          result.push(pickRandom(pool)); // A√±ade un car√°cter aleatorio del pool
        }
        shuffle(result); // Mezcla para distribuir los obligatorios
        return result.join(""); // Une en un string y devuelve
      };

      const refresh = () => {
        // Genera y refleja contrase√±a/estado en la UI
        const pwd = generatePassword(); // Genera una nueva contrase√±a
        passwordOutput.value = pwd; // Muestra la contrase√±a en el input de salida
        updateStrengthUI(pwd, buildPool().length); // Actualiza barra/etiquetas usando tama√±o del pool
      };

      // =====================
      // Copiado al portapapeles
      // =====================

      const copyToClipboard = async () => {
        // Copia la contrase√±a actual al portapapeles
        const value = passwordOutput.value; // Lee la contrase√±a actual del input
        if (!value) return; // Si no hay contrase√±a, no hace nada
        try {
          // Intenta usar la API del portapapeles
          await navigator.clipboard.writeText(value); // Escribe el texto en el portapapeles
          copyBtn.textContent = "¬°Copiado!"; // Feedback visual de √©xito
          setTimeout(() => (copyBtn.textContent = "Copiar"), 1200); // Restaura el texto del bot√≥n tras 1.2s
        } catch {
          // Si falla (permisos o entorno)
          passwordOutput.select(); // Selecciona el texto como alternativa manual
          document.execCommand("copy"); // Intenta copiar usando comando heredado
          copyBtn.textContent = "¬°Copiado!"; // Feedback de √©xito
          setTimeout(() => (copyBtn.textContent = "Copiar"), 1200); // Restaura texto del bot√≥n
        }
      };

      // =====================
      // Eventos de UI
      // =====================

      generateBtn.addEventListener("click", refresh); // Genera una contrase√±a al presionar el bot√≥n
      copyBtn.addEventListener("click", copyToClipboard); // Copia la contrase√±a al presionar el bot√≥n

      [includeLower, includeUpper, includeNumbers, includeSymbols].forEach(
        (el) => {
          // Para cada checkbox
          el.addEventListener("change", () => {
            // Cuando cambie el valor
            if (
              !includeLower.checked &&
              !includeUpper.checked &&
              !includeNumbers.checked &&
              !includeSymbols.checked
            ) {
              // Si se desmarcaron todos
              includeLower.checked = true; // Vuelve a marcar min√∫sculas para evitar pool vac√≠o
            }
            refresh(); // Regenera la contrase√±a acorde a la nueva selecci√≥n
          });
        }
      );

      [lengthRange, lengthNumber].forEach((el) => {
        // Para los controles de longitud
        el.addEventListener("change", refresh); // Regenera al confirmar el cambio
      });

      // =====================
      // Inicio autom√°tico
      // =====================

      syncLength(16); // Inicializa controles con 16
      refresh(); // Genera la primera contrase√±a autom√°ticamente al cargar
    </script>
    <!-- Fin del script JavaScript -->
  </body>
</html>
