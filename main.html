<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Generador de Contraseñas Seguras</title>
    <style>
      :root {
        --bg: #0b1020;
        --card: #121a33;
        --text: #e8ecff;
        --muted: #9fb0ff;
        --accent: #6ea8ff;
        --good: #22c55e;
        --warn: #f59e0b;
        --bad: #ef4444;
        --radius: 16px;
      }

      * {
        box-sizing: border-box;
      }

      body {
        margin: 0;
        font-family: ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto,
          "Helvetica Neue", Arial, "Noto Sans", "Apple Color Emoji",
          "Segoe UI Emoji";
        color: var(--text);
        background: radial-gradient(
          1200px 800px at 10% 10%,
          #0e1633 0%,
          var(--bg) 40%,
          #070a16 100%
        );
        min-height: 100svh; /* Asegura cubrir alto de la pantalla */
        display: flex; /* Usa Flexbox para centrar el contenido */
        align-items: center; /* Centra verticalmente */
        justify-content: center;
        padding: 24px;
      }

      .app {
        /* Contenedor principal de la app */
        display: flex; /* Habilita layout flexible */
        flex-direction: column; /* Acomoda elementos en columna */
        gap: 16px; /* Espaciado entre hijos */
        width: 100%; /* Ocupa todo el ancho disponible */
        max-width: 720px; /* Limita el ancho máximo para buena lectura */
        background: var(--card); /* Fondo de tarjeta */
        border-radius: var(--radius); /* Bordes redondeados suaves */
        box-shadow: 0 20px 60px rgba(0, 0, 0, 0.35); /* Sombra para profundidad */
        padding: 20px; /* Espaciado interno del contenedor */
        border: 1px solid rgba(255, 255, 255, 0.06); /* Borde sutil para contraste */
      }

      header {
        /* Encabezado de la app */
        display: flex; /* Layout horizontal */
        align-items: center; /* Centra verticalmente el contenido */
        justify-content: space-between; /* Separa título y acciones */
        gap: 12px; /* Espaciado entre elementos */
        flex-wrap: wrap; /* Permite que pase a otra línea en pantallas estrechas */
      }

      h1 {
        /* Estilo del título principal */
        font-size: clamp(18px, 3.5vw, 24px); /* Tamaño fluido del texto */
        margin: 0; /* Sin margen para ajuste fino */
        letter-spacing: 0.2px; /* Espaciado leve de letras */
      }

      .muted {
        color: var(--muted);
      } /* Clase de texto secundario */

      .row {
        /* Línea flexible para agrupar controles */
        display: flex; /* Activa Flexbox */
        gap: 12px; /* Espaciado entre elementos */
        align-items: center; /* Alinea verticalmente los hijos */
        flex-wrap: wrap; /* Permite salto de línea si falta espacio */
      }

      .field {
        /* Contenedor de campo/entrada */
        display: flex; /* Flexbox para alinear etiqueta y control */
        flex-direction: column; /* Coloca etiqueta arriba y control abajo */
        gap: 8px; /* Espaciado entre etiqueta y control */
        flex: 1; /* Que ocupe el espacio disponible */
        min-width: 220px; /* Previene que encoja demasiado */
      }

      label {
        /* Estilo general de etiquetas */
        font-size: 14px; /* Tamaño legible para etiquetas */
        color: var(--muted); /* Color secundario */
      }

      input[type="text"] {
        /* Estilo del campo de contraseña generada */
        width: 100%; /* Ocupa todo el ancho del contenedor */
        padding: 14px 16px; /* Espaciado interno confortable */
        border-radius: 12px; /* Bordes redondeados */
        background: #0f1630; /* Fondo oscuro para contraste */
        border: 1px solid rgba(255, 255, 255, 0.08); /* Borde sutil */
        color: var(--text); /* Texto claro sobre fondo oscuro */
        font-size: 16px; /* Tamaño de fuente legible */
        letter-spacing: 0.6px; /* Aumenta legibilidad de contraseñas */
      }

      button {
        /* Estilo base para botones */
        padding: 12px 16px; /* Espaciado interno cómodo */
        background: linear-gradient(
          180deg,
          #3b82f6,
          #2563eb
        ); /* Gradiente azul para llamar la atención */
        color: white; /* Texto blanco sobre fondo azul */
        border: none; /* Sin borde por defecto */
        border-radius: 12px; /* Bordes redondeados suaves */
        cursor: pointer; /* Cambia cursor a mano para indicar acción */
        font-weight: 600; /* Peso de fuente para resaltar */
        box-shadow: 0 8px 24px rgba(59, 130, 246, 0.35); /* Sombra sutil para profundidad */
        transition: transform 0.08s ease; /* Animación suave al presionar */
      }

      button:active {
        transform: translateY(1px);
      } /* Efecto al hacer click */

      .options {
        /* Contenedor de opciones de generación */
        display: grid; /* Usa grid para distribuir opciones */
        grid-template-columns: repeat(
          auto-fit,
          minmax(220px, 1fr)
        ); /* Columas responsivas */
        gap: 12px; /* Espaciado entre opciones */
      }

      .optionCard {
        /* Tarjeta para cada opción */
        display: flex; /* Flexbox para contenido interno */
        align-items: center; /* Centra verticalmente */
        gap: 10px; /* Espaciado entre checkbox/label */
        background: #0f1630; /* Fondo oscuro coherente */
        padding: 12px; /* Espaciado interno */
        border-radius: 12px; /* Bordes redondeados */
        border: 1px solid rgba(255, 255, 255, 0.06); /* Borde sutil */
      }

      .rangeRow {
        /* Fila que contiene el slider de longitud */
        display: flex; /* Flexbox horizontal */
        align-items: center; /* Centra verticalmente */
        gap: 12px; /* Espaciado entre slider y número */
      }

      input[type="range"] {
        /* Estilo para el control deslizante */
        width: 100%; /* Que ocupe el ancho disponible */
        accent-color: var(
          --accent
        ); /* Color del pulgar/track soportado por navegadores modernos */
      }

      .meter {
        /* Contenedor de la barra de fuerza */
        width: 100%; /* Ocupa el ancho disponible */
        height: 12px; /* Alto de la barra */
        border-radius: 999px; /* Bordes redondeados completos */
        background: rgba(255, 255, 255, 0.08); /* Fondo base de la barra */
        overflow: hidden; /* Recorta el progreso a los bordes redondeados */
        border: 1px solid rgba(255, 255, 255, 0.06); /* Borde sutil */
      }

      .meterFill {
        /* Barra interior que representa la fuerza */
        height: 100%; /* Misma altura que el contenedor */
        width: 0%; /* Ancho inicial (0%) hasta calcular */
        background: linear-gradient(
          90deg,
          var(--bad),
          var(--warn),
          var(--good)
        ); /* Gradiente de rojo a verde */
        transition: width 0.2s ease; /* Animación suave al cambiar */
      }

      .entropy {
        /* Texto que muestra bits de entropía */
        font-variant-numeric: tabular-nums; /* Alinea números para fácil lectura */
      }

      .footer {
        /* Pie con nota informativa */
        color: var(--muted); /* Color secundario */
        font-size: 13px; /* Tamaño pequeño */
        line-height: 1.4; /* Altura de línea cómoda */
      }
    </style>
    <!-- Fin de estilos CSS -->
  </head>
  <body>
    <!-- Cuerpo del documento donde se muestra la app -->
    <main class="app" role="region" aria-label="Generador de contraseñas">
      <!-- Contenedor principal con rol accesible -->
      <header>
        <!-- Encabezado con título y acciones -->
        <h1>🔐 Generador de contraseñas seguras</h1>
        <!-- Título visible de la aplicación -->
        <div class="row">
          <!-- Fila para acciones rápidas -->
          <button
            id="copyBtn"
            type="button"
            aria-live="polite"
            title="Copiar contraseña"
          >
            Copiar
          </button>
          <!-- Botón para copiar al portapapeles -->
          <button
            id="generateBtn"
            type="button"
            title="Generar nueva contraseña"
          >
            Generar
          </button>
          <!-- Botón para generar contraseña -->
        </div>
      </header>

      <div class="field">
        <!-- Campo que muestra la contraseña generada -->
        <label for="passwordOutput">Contraseña</label>
        <!-- Etiqueta accesible del campo -->
        <input
          id="passwordOutput"
          type="text"
          placeholder="Toca Generar"
          aria-readonly="true"
          readonly
        />
        <!-- Caja de texto de solo lectura para mostrar la contraseña -->
      </div>

      <section class="options" aria-label="Opciones de generación">
        <!-- Sección con opciones personalizables -->
        <div class="field">
          <!-- Campo para seleccionar longitud -->
          <label for="lengthRange"
            >Longitud: <strong id="lengthValue">16</strong> caracteres</label
          >
          <!-- Etiqueta del slider con valor actual -->
          <div class="rangeRow">
            <!-- Contenedor del slider y número -->
            <input
              id="lengthRange"
              type="range"
              min="8"
              max="64"
              value="16"
              step="1"
              aria-valuemin="8"
              aria-valuemax="64"
              aria-valuenow="16"
            />
            <!-- Control deslizante de longitud -->
            <input
              id="lengthNumber"
              type="number"
              min="8"
              max="64"
              value="16"
              step="1"
              aria-label="Longitud en número"
              style="width: 90px"
            />
            <!-- Campo numérico sincronizado -->
          </div>
        </div>

        <div class="optionCard">
          <!-- Opción para incluir minúsculas -->
          <input
            id="includeLower"
            type="checkbox"
            checked
            aria-label="Incluir minúsculas"
          />
          <!-- Checkbox de minúsculas -->
          <label for="includeLower">Incluir minúsculas (a–z)</label>
          <!-- Etiqueta descriptiva -->
        </div>

        <div class="optionCard">
          <!-- Opción para incluir mayúsculas -->
          <input
            id="includeUpper"
            type="checkbox"
            checked
            aria-label="Incluir mayúsculas"
          />
          <!-- Checkbox de mayúsculas -->
          <label for="includeUpper">Incluir mayúsculas (A–Z)</label>
          <!-- Etiqueta descriptiva -->
        </div>

        <div class="optionCard">
          <!-- Opción para incluir números -->
          <input
            id="includeNumbers"
            type="checkbox"
            checked
            aria-label="Incluir números"
          />
          <!-- Checkbox de números -->
          <label for="includeNumbers">Incluir números (0–9)</label>
          <!-- Etiqueta descriptiva -->
        </div>

        <div class="optionCard">
          <!-- Opción para incluir símbolos -->
          <input
            id="includeSymbols"
            type="checkbox"
            aria-label="Incluir símbolos"
          />
          <!-- Checkbox de símbolos -->
          <label for="includeSymbols">Incluir símbolos (!@#$…)</label>
          <!-- Etiqueta descriptiva -->
        </div>
      </section>

      <section aria-label="Fuerza de la contraseña">
        <!-- Sección para barra de fuerza y texto -->
        <div class="row">
          <!-- Fila que aloja barra y etiquetas -->
          <div class="meter" aria-hidden="true">
            <!-- Contenedor visual de la barra -->
            <div id="meterFill" class="meterFill"></div>
            <!-- Relleno que crece según fuerza -->
          </div>
          <span id="strengthLabel" class="muted">Fuerza: —</span>
          <!-- Texto que describe la fuerza -->
          <span
            id="entropyBits"
            class="muted entropy"
            title="Estimación teórica basada en longitud y variedad de caracteres"
            >Entropía: — bits</span
          >
          <!-- Texto que muestra entropía -->
        </div>
      </section>

      <p class="footer">
        <!-- Nota informativa al usuario -->
        Consejo: usá una contraseña <em>larga</em> y activá
        <strong>símbolos</strong>. Guardala en un gestor de contraseñas. La
        entropía es una estimación teórica (no analiza palabras del
        diccionario).
      </p>
    </main>

    <script>
      // Comienza el script JavaScript
      // =====================
      // Utilidades aleatorias
      // =====================

      const cryptoRand = (maxExclusive) => {
        // Genera un entero aleatorio seguro de 0 a maxExclusive-1
        const array = new Uint32Array(1); // Crea un arreglo para almacenar un entero de 32 bits
        crypto.getRandomValues(array); // Llena el arreglo con números aleatorios criptográficamente fuertes
        return array[0] % maxExclusive; // Devuelve el número dentro del rango usando módulo
      };

      const pickRandom = (str) => str[cryptoRand(str.length)]; // Elige un carácter aleatorio de un string

      const shuffle = (arr) => {
        // Mezcla un arreglo in-place con Fisher–Yates
        for (let i = arr.length - 1; i > 0; i--) {
          // Recorre el arreglo de atrás hacia adelante
          const j = cryptoRand(i + 1); // Elige índice aleatorio entre 0 e i inclusive
          [arr[i], arr[j]] = [arr[j], arr[i]]; // Intercambia los elementos en i y j
        }
        return arr; // Devuelve el arreglo mezclado
      };

      // =====================
      // Conjuntos de caracteres
      // =====================

      const LOWER = "abcdefghijklmnopqrstuvwxyz"; // Define las letras minúsculas
      const UPPER = "ABCDEFGHIJKLMNOPQRSTUVWXYZ"; // Define las letras mayúsculas
      const DIGITS = "0123456789"; // Define los dígitos numéricos
      const SYMBOLS = "!@#$%^&*()-_=+[]{};:,.<>/?|~"; // Define símbolos comunes

      // =====================
      // Referencias a elementos
      // =====================

      const passwordOutput = document.getElementById("passwordOutput"); // Obtiene el input de salida
      const lengthRange = document.getElementById("lengthRange"); // Obtiene el slider de longitud
      const lengthNumber = document.getElementById("lengthNumber"); // Obtiene el input numérico de longitud
      const lengthValue = document.getElementById("lengthValue"); // Obtiene el span que muestra el valor

      const includeLower = document.getElementById("includeLower"); // Checkbox de minúsculas
      const includeUpper = document.getElementById("includeUpper"); // Checkbox de mayúsculas
      const includeNumbers = document.getElementById("includeNumbers"); // Checkbox de números
      const includeSymbols = document.getElementById("includeSymbols"); // Checkbox de símbolos

      const meterFill = document.getElementById("meterFill"); // Barra de fuerza visual
      const strengthLabel = document.getElementById("strengthLabel"); // Texto de fuerza
      const entropyBits = document.getElementById("entropyBits"); // Texto de entropía

      const generateBtn = document.getElementById("generateBtn"); // Botón de generar
      const copyBtn = document.getElementById("copyBtn"); // Botón de copiar

      // =====================
      // Sincronización de longitud
      // =====================

      const syncLength = (value) => {
        // Mantiene sincronizados slider, número y etiqueta
        const v = Math.max(8, Math.min(64, Number(value))); // Asegura que el valor esté en rango 8–64
        lengthRange.value = String(v); // Actualiza el slider con el valor
        lengthNumber.value = String(v); // Actualiza el input numérico
        lengthValue.textContent = String(v); // Actualiza el texto visible
      };

      lengthRange.addEventListener("input", (e) => syncLength(e.target.value)); // Sincroniza al mover el slider
      lengthNumber.addEventListener("input", (e) => syncLength(e.target.value)); // Sincroniza al cambiar el número

      // =====================
      // Cálculo de entropía y fuerza
      // =====================

      const log2 = (n) => Math.log(n) / Math.log(2); // Convierte logaritmo natural a base 2

      const estimateEntropyBits = (length, poolSize) => length * log2(poolSize); // Estima bits de entropía = L * log2(pool)

      const strengthFromEntropy = (bits) => {
        // Mapea bits a una etiqueta y porcentaje
        if (bits < 50) return { label: "Débil", pct: 20, color: "var(--bad)" }; // Menos de 50 bits = débil
        if (bits < 80) return { label: "Media", pct: 45, color: "var(--warn)" }; // 50–79 bits = media
        if (bits < 110)
          return { label: "Fuerte", pct: 75, color: "var(--accent)" }; // 80–109 bits = fuerte
        return { label: "Excelente", pct: 100, color: "var(--good)" }; // 110+ bits = excelente
      };

      const updateStrengthUI = (pwd, poolSize) => {
        // Actualiza barra/etiquetas según contraseña
        const bits = pwd.length ? estimateEntropyBits(pwd.length, poolSize) : 0; // Calcula entropía si hay contraseña
        const { label, pct, color } = strengthFromEntropy(bits); // Obtiene etiqueta/porcentaje/color
        meterFill.style.width = pct + "%"; // Ajusta el ancho de la barra
        meterFill.style.background = color; // Ajusta el color según fuerza
        strengthLabel.textContent = "Fuerza: " + (pwd ? label : "—"); // Actualiza etiqueta de fuerza
        entropyBits.textContent =
          "Entropía: " + (pwd ? bits.toFixed(1) : "—") + " bits"; // Muestra bits con 1 decimal
      };

      // =====================
      // Generación de contraseña
      // =====================

      const buildPool = () => {
        // Construye el conjunto total de caracteres seleccionados
        let pool = ""; // Inicializa el pool vacío
        if (includeLower.checked) pool += LOWER; // Agrega minúsculas si está marcado
        if (includeUpper.checked) pool += UPPER; // Agrega mayúsculas si está marcado
        if (includeNumbers.checked) pool += DIGITS; // Agrega dígitos si está marcado
        if (includeSymbols.checked) pool += SYMBOLS; // Agrega símbolos si está marcado
        return pool; // Devuelve el pool final
      };

      const atLeastOneFromEach = () => {
        // Garantiza al menos un carácter de cada tipo seleccionado
        const chars = []; // Arreglo para caracteres obligatorios
        if (includeLower.checked) chars.push(pickRandom(LOWER)); // Añade una minúscula si aplica
        if (includeUpper.checked) chars.push(pickRandom(UPPER)); // Añade una mayúscula si aplica
        if (includeNumbers.checked) chars.push(pickRandom(DIGITS)); // Añade un dígito si aplica
        if (includeSymbols.checked) chars.push(pickRandom(SYMBOLS)); // Añade un símbolo si aplica
        return chars; // Devuelve los caracteres obligatorios
      };

      const generatePassword = () => {
        // Genera la contraseña final según opciones
        const length = Number(lengthRange.value); // Lee la longitud elegida
        const pool = buildPool(); // Construye el conjunto de caracteres
        if (!pool) {
          // Si no hay conjuntos seleccionados
          alert("Seleccioná al menos un tipo de carácter."); // Muestra alerta al usuario
          return ""; // Devuelve cadena vacía para indicar falla
        }
        const mustHave = atLeastOneFromEach(); // Obtiene caracteres obligatorios
        const result = [...mustHave]; // Inicia el resultado con los obligatorios
        while (result.length < length) {
          // Completa hasta alcanzar la longitud
          result.push(pickRandom(pool)); // Añade un carácter aleatorio del pool
        }
        shuffle(result); // Mezcla para distribuir los obligatorios
        return result.join(""); // Une en un string y devuelve
      };

      const refresh = () => {
        // Genera y refleja contraseña/estado en la UI
        const pwd = generatePassword(); // Genera una nueva contraseña
        passwordOutput.value = pwd; // Muestra la contraseña en el input de salida
        updateStrengthUI(pwd, buildPool().length); // Actualiza barra/etiquetas usando tamaño del pool
      };

      // =====================
      // Copiado al portapapeles
      // =====================

      const copyToClipboard = async () => {
        // Copia la contraseña actual al portapapeles
        const value = passwordOutput.value; // Lee la contraseña actual del input
        if (!value) return; // Si no hay contraseña, no hace nada
        try {
          // Intenta usar la API del portapapeles
          await navigator.clipboard.writeText(value); // Escribe el texto en el portapapeles
          copyBtn.textContent = "¡Copiado!"; // Feedback visual de éxito
          setTimeout(() => (copyBtn.textContent = "Copiar"), 1200); // Restaura el texto del botón tras 1.2s
        } catch {
          // Si falla (permisos o entorno)
          passwordOutput.select(); // Selecciona el texto como alternativa manual
          document.execCommand("copy"); // Intenta copiar usando comando heredado
          copyBtn.textContent = "¡Copiado!"; // Feedback de éxito
          setTimeout(() => (copyBtn.textContent = "Copiar"), 1200); // Restaura texto del botón
        }
      };

      // =====================
      // Eventos de UI
      // =====================

      generateBtn.addEventListener("click", refresh); // Genera una contraseña al presionar el botón
      copyBtn.addEventListener("click", copyToClipboard); // Copia la contraseña al presionar el botón

      [includeLower, includeUpper, includeNumbers, includeSymbols].forEach(
        (el) => {
          // Para cada checkbox
          el.addEventListener("change", () => {
            // Cuando cambie el valor
            if (
              !includeLower.checked &&
              !includeUpper.checked &&
              !includeNumbers.checked &&
              !includeSymbols.checked
            ) {
              // Si se desmarcaron todos
              includeLower.checked = true; // Vuelve a marcar minúsculas para evitar pool vacío
            }
            refresh(); // Regenera la contraseña acorde a la nueva selección
          });
        }
      );

      [lengthRange, lengthNumber].forEach((el) => {
        // Para los controles de longitud
        el.addEventListener("change", refresh); // Regenera al confirmar el cambio
      });

      // =====================
      // Inicio automático
      // =====================

      syncLength(16); // Inicializa controles con 16
      refresh(); // Genera la primera contraseña automáticamente al cargar
    </script>
    <!-- Fin del script JavaScript -->
  </body>
</html>
